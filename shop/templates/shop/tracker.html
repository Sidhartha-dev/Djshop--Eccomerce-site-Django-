{% extends 'shop/basic.html' %} 
{% block title %} 
track this Product- Djshop
{%endblock title %} 
{% block body %}
<div class="container">
  <div class="col">
    <h3 class="my-4">
      <u>Step-1 DjShop Quick tracking | Track items</u>
    </h3>
    <h5 class="text-danger">To Track your order Put your order Id and Email Address</h5>
    <div class="my-4">
      <form method="post" action="/shop/checkout/">
          {% csrf_token %}
           <input type="number" name="OrderId" id="OrderId" class="form-control my-4 rounded-pill shadow col-md-6" placeholder="Order Id"> 
           <input type="email" name="email" id="email" class="form-control my-4 rounded-pill shadow col-md-6" placeholder="Enter Email..."> 
           <button class="btn btn-warning rounded-pill shadow mt-4">Track Order</button>
        </form>
    </div>
  </div>

  <div class="col my-3">
    <h3>Your Order Status</h3>
    <div class="my-4">
       <ul class="list-group" id="items">
           
       </ul>
    </div>
  </div>
  
</div>

{% block js %}
<script>
  if (localStorage.getItem("cart") == null) {
    var cart = {};
  } else {
    cart = JSON.parse(localStorage.getItem("cart"));
  }
  console.log(cart);
  var sum = 0;
  if ($.isEmptyObject(cart)){
    //if object is empty
    mystr = '<h3 class="text-danger">Your cart Is empty, Add some items in your cart before checkout</h3>'
    $('#items').append(mystr);
  }else{
   for(item in cart){
     let name = cart[item][1];
     let qty = cart[item][0];
     sum = sum + qty;
     mystr = `<li class="list-group-item d-flex justify-content-between align-items-center">
       ${name}
          <span class="badge badge-success badge-pill">${qty}</span>
     </li>`

     $('#items').append(mystr);
   }
  }

  document.getElementById('cart').innerHTML = sum;
  $('#itemsJson').val(JSON.stringify(cart));
  {% if thank %}
  alert('Thanks for ordering. Your order ID: {{id}}. Use it to track your Order by Tracker');
  localStorage.clear();
  document.location ="/shop"
  {% endif %}
</script>
{% endblock js %} 
{% endblock body %}
